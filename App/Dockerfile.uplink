FROM python:3.9-slim

WORKDIR /app

# Install dependencies
RUN pip install flask mysql-connector-python

# Copy source code
COPY App/uplink_server.py /app/App/uplink_server.py
COPY common/ /app/common/

# Ensure data directories exist
RUN mkdir -p /app/App/json /app/App/data

# Environment variables
ENV PYTHONPATH=/app
ENV MYSQL_HOST=db
ENV MYSQL_PORT=3306

EXPOSE 5001

CMD ["python", "App/uplink_server.py"]
